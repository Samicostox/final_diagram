{"ast":null,"code":"import * as React from 'react';\nimport { TransformLayerWidget } from '../layer/TransformLayerWidget';\nimport styled from '@emotion/styled';\nimport { SmartLayerWidget } from '../layer/SmartLayerWidget';\nvar S;\n(function (S) {\n  S.Canvas = styled.div`\n\t\tposition: relative;\n\t\tcursor: move;\n\t\toverflow: hidden;\n\t`;\n})(S || (S = {}));\nexport class CanvasWidget extends React.Component {\n  constructor(props) {\n    super(props);\n    this.ref = React.createRef();\n    this.state = {\n      action: null,\n      diagramEngineListener: null\n    };\n  }\n  componentWillUnmount() {\n    this.props.engine.deregisterListener(this.canvasListener);\n    this.props.engine.setCanvas(null);\n    document.removeEventListener('keyup', this.keyUp);\n    document.removeEventListener('keydown', this.keyDown);\n  }\n  registerCanvas() {\n    this.props.engine.setCanvas(this.ref.current);\n    this.props.engine.iterateListeners(list => {\n      list.rendered && list.rendered();\n    });\n  }\n  componentDidUpdate() {\n    this.registerCanvas();\n  }\n  componentDidMount() {\n    this.canvasListener = this.props.engine.registerListener({\n      repaintCanvas: () => {\n        this.forceUpdate();\n      }\n    });\n    this.keyDown = event => {\n      this.props.engine.getActionEventBus().fireAction({\n        event\n      });\n    };\n    this.keyUp = event => {\n      this.props.engine.getActionEventBus().fireAction({\n        event\n      });\n    };\n    document.addEventListener('keyup', this.keyUp);\n    document.addEventListener('keydown', this.keyDown);\n    this.registerCanvas();\n  }\n  render() {\n    const engine = this.props.engine;\n    const model = engine.getModel();\n    return React.createElement(S.Canvas, {\n      className: this.props.className,\n      ref: this.ref,\n      onWheel: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onMouseDown: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onMouseUp: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onMouseMove: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onTouchStart: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onTouchEnd: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      },\n      onTouchMove: event => {\n        this.props.engine.getActionEventBus().fireAction({\n          event\n        });\n      }\n    }, model.getLayers().map(layer => {\n      return React.createElement(TransformLayerWidget, {\n        layer: layer,\n        key: layer.getID()\n      }, React.createElement(SmartLayerWidget, {\n        layer: layer,\n        engine: this.props.engine,\n        key: layer.getID()\n      }));\n    }));\n  }\n}","map":{"version":3,"names":["React","TransformLayerWidget","styled","SmartLayerWidget","S","Canvas","div","CanvasWidget","Component","constructor","props","ref","createRef","state","action","diagramEngineListener","componentWillUnmount","engine","deregisterListener","canvasListener","setCanvas","document","removeEventListener","keyUp","keyDown","registerCanvas","current","iterateListeners","list","rendered","componentDidUpdate","componentDidMount","registerListener","repaintCanvas","forceUpdate","event","getActionEventBus","fireAction","addEventListener","render","model","getModel","createElement","className","onWheel","onMouseDown","onMouseUp","onMouseMove","onTouchStart","onTouchEnd","onTouchMove","getLayers","map","layer","key","getID"],"sources":["C:\\Users\\samir\\Diagram gen\\diagram-sami\\node_modules\\@projectstorm\\react-canvas-core\\src\\entities\\canvas\\CanvasWidget.tsx"],"sourcesContent":["import * as React from 'react';\nimport { CanvasEngine } from '../../CanvasEngine';\nimport { TransformLayerWidget } from '../layer/TransformLayerWidget';\nimport styled from '@emotion/styled';\nimport { SmartLayerWidget } from '../layer/SmartLayerWidget';\n\nexport interface DiagramProps {\n\tengine: CanvasEngine;\n\tclassName?: string;\n}\n\nnamespace S {\n\texport const Canvas = styled.div`\n\t\tposition: relative;\n\t\tcursor: move;\n\t\toverflow: hidden;\n\t`;\n}\n\nexport class CanvasWidget extends React.Component<DiagramProps> {\n\tref: React.RefObject<HTMLDivElement>;\n\tkeyUp: any;\n\tkeyDown: any;\n\tcanvasListener: any;\n\n\tconstructor(props: DiagramProps) {\n\t\tsuper(props);\n\n\t\tthis.ref = React.createRef();\n\t\tthis.state = {\n\t\t\taction: null,\n\t\t\tdiagramEngineListener: null\n\t\t};\n\t}\n\n\tcomponentWillUnmount() {\n\t\tthis.props.engine.deregisterListener(this.canvasListener);\n\t\tthis.props.engine.setCanvas(null);\n\n\t\tdocument.removeEventListener('keyup', this.keyUp);\n\t\tdocument.removeEventListener('keydown', this.keyDown);\n\t}\n\n\tregisterCanvas() {\n\t\tthis.props.engine.setCanvas(this.ref.current);\n\t\tthis.props.engine.iterateListeners((list) => {\n\t\t\tlist.rendered && list.rendered();\n\t\t});\n\t}\n\n\tcomponentDidUpdate() {\n\t\tthis.registerCanvas();\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.canvasListener = this.props.engine.registerListener({\n\t\t\trepaintCanvas: () => {\n\t\t\t\tthis.forceUpdate();\n\t\t\t}\n\t\t});\n\n\t\tthis.keyDown = (event) => {\n\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t};\n\t\tthis.keyUp = (event) => {\n\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t};\n\n\t\tdocument.addEventListener('keyup', this.keyUp);\n\t\tdocument.addEventListener('keydown', this.keyDown);\n\t\tthis.registerCanvas();\n\t}\n\n\trender() {\n\t\tconst engine = this.props.engine;\n\t\tconst model = engine.getModel();\n\n\t\treturn (\n\t\t\t<S.Canvas\n\t\t\t\tclassName={this.props.className}\n\t\t\t\tref={this.ref}\n\t\t\t\tonWheel={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonMouseDown={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonMouseUp={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonMouseMove={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonTouchStart={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonTouchEnd={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t\tonTouchMove={(event) => {\n\t\t\t\t\tthis.props.engine.getActionEventBus().fireAction({ event });\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{model.getLayers().map((layer) => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<TransformLayerWidget layer={layer} key={layer.getID()}>\n\t\t\t\t\t\t\t<SmartLayerWidget layer={layer} engine={this.props.engine} key={layer.getID()} />\n\t\t\t\t\t\t</TransformLayerWidget>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</S.Canvas>\n\t\t);\n\t}\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}